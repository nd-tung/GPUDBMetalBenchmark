Metal library compiled from source at runtime
--- Running Selection Benchmark ---
Loaded 59986052 rows for selection.
--- Filter Value: < 1000 ---
Selectivity: 0.0500083% (29998 rows matched)
GPU execution time: 0.735 ms
Effective Bandwidth: 304.035 GB/s

--- Filter Value: < 10000 ---
Selectivity: 0.500381% (300159 rows matched)
GPU execution time: 0.64 ms
Effective Bandwidth: 349.165 GB/s

--- Filter Value: < 50000 ---
Selectivity: 2.50079% (1500128 rows matched)
GPU execution time: 0.63575 ms
Effective Bandwidth: 351.499 GB/s

--- Running Aggregation Benchmark ---
Loaded 59986052 rows for aggregation.
Final SUM(l_quantity): 1.52974e+09
GPU execution time: 0.635042 ms
Effective Bandwidth: 351.891 GB/s

--- Running Join Benchmark ---
Loaded 15000000 rows from orders.tbl for build phase.
Loaded 59986052 rows from lineitem.tbl for probe phase.
Join complete. Found 59986052 total matches.
Build Phase GPU time: 3.605 ms
Probe Phase GPU time: 5.45463 ms
Total Join GPU time: 9.05962 ms

--- Running TPC-H Query 1 Benchmark ---

+----------+----------+------------+----------------+----------------+----------------+------------+------------+------------+----------+
| l_return | l_linest |    sum_qty | sum_base_price | sum_disc_price |     sum_charge |    avg_qty |  avg_price |   avg_disc | count    |
+----------+----------+------------+----------------+----------------+----------------+------------+------------+------------+----------+
|        A |        F | 377518399.00 | 566065732718.08 | 537759111439.15 | 559276679431.47 |      25.50 |   38237.15 |       0.05 | 14804077 |
|        N |        F | 9851614.00 | 14767438527.06 | 14028805977.04 | 14590491218.77 |      25.52 |   38257.81 |       0.05 |   385998 |
|        N |        O | 743124873.00 | 1114302296600.68 | 1058580936254.71 | 1100937016982.74 |      25.50 |   38233.90 |       0.05 | 29144351 |
|        R |        F | 377732830.00 | 566431059914.70 | 538110929831.45 | 559634789413.51 |      25.51 |   38251.22 |       0.05 | 14808183 |
+----------+----------+------------+----------------+----------------+----------------+------------+------------+------------+----------+

Q1 | 59986052 rows
  CPU Parsing (.tbl):  148611.18 ms
  GPU Execution:           10.77 ms
  CPU Post Process:         0.02 ms
  Total Execution:         10.79 ms  (GPU + CPU post)

--- Running TPC-H Query 3 Benchmark ---
Loaded 1500000 customers, 15000000 orders, 59986052 lineitem rows.

TPC-H Query 3 Results (Top 10):
+----------+------------+------------+--------------+
| orderkey |   revenue  | orderdate  | shippriority |
+----------+------------+------------+--------------+
|  4791171 | $ 440715.19 |   19950223 |            0 |
| 46678469 | $ 439855.34 |   19950127 |            0 |
| 23906758 | $ 432728.56 |   19950314 |            0 |
| 23861382 | $ 428739.16 |   19950309 |            0 |
| 59393639 | $ 426036.06 |   19950212 |            0 |
|  3355202 | $ 425100.69 |   19950304 |            0 |
|  9806272 | $ 425088.06 |   19950313 |            0 |
| 22810436 | $ 423232.00 |   19950102 |            0 |
| 16384100 | $ 421478.75 |   19950302 |            0 |
| 52974151 | $ 415367.12 |   19950205 |            0 |
+----------+------------+------------+--------------+
Total results found: 114003

Q3 | 59986052 rows (lineitem)
  CPU Parsing (.tbl):  103755.82 ms
  GPU Execution:            1.87 ms
  CPU Post Process:        15.20 ms
  Total Execution:         17.07 ms  (GPU + CPU post)
--- Running TPC-H Query 6 Benchmark ---
Loaded 59986052 rows for TPC-H Query 6.
TPC-H Query 6 Result:
Total Revenue: $1230114048.00

Q6 | 59986052 rows
  CPU Parsing (.tbl):   85284.58 ms
  GPU Execution:            0.81 ms
  CPU Post Process:         0.00 ms
  Total Execution:          0.82 ms  (GPU + CPU post)
  Bandwidth:             1097.83 GB/s

--- Running TPC-H Query 9 Benchmark ---
Loaded data for all tables.
Part size: 2000000, Supplier size: 100000, Lineitem size: 59986052
Found 108782 parts with 'green' in name (CPU check).
Max PartKey: 2000000
Max SuppKey: 100000

TPC-H Query 9 Results (Top 15):
+------------+------+---------------+
| Nation     | Year |        Profit |
+------------+------+---------------+
| ALGERIA    | 1998 | $ 214982848.00 |
| ALGERIA    | 1997 | $ 393630272.00 |
| ALGERIA    | 1996 | $ 396224288.00 |
| ALGERIA    | 1995 | $ 401579840.00 |
| ALGERIA    | 1994 | $ 395342624.00 |
| ALGERIA    | 1993 | $ 396344320.00 |
| ALGERIA    | 1992 | $ 396480608.00 |
| ARGENTINA  | 1998 | $ 219442384.00 |
| ARGENTINA  | 1997 | $ 406365600.00 |
| ARGENTINA  | 1996 | $ 411051680.00 |
| ARGENTINA  | 1995 | $ 406375648.00 |
| ARGENTINA  | 1994 | $ 404822528.00 |
| ARGENTINA  | 1993 | $ 410196256.00 |
| ARGENTINA  | 1992 | $ 410010624.00 |
| BRAZIL     | 1998 | $ 222340368.00 |
+------------+------+---------------+
Total results found: 175

Comparable TPC-H Q9 (yearly sum_profit):
+--------+---------------+
| o_year |   sum_profit  |
+--------+---------------+
|   1992 | 10172829568.0000 |
|   1993 | 10148879360.0000 |
|   1994 | 10191915040.0000 |
|   1995 | 10123487808.0000 |
|   1996 | 10151411040.0000 |
|   1997 | 10098613216.0000 |
|   1998 | 5474135632.0000 |
+--------+---------------+

Q9 | 59986052 rows (lineitem)
  CPU Parsing (.tbl):  138807.08 ms
  GPU Execution:           54.18 ms
  CPU Post Process:         0.06 ms
  Total Execution:         54.23 ms  (GPU + CPU post)

--- Running TPC-H Query 13 Benchmark ---
